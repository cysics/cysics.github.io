카카오톡 대화 전처리(2)
================
김종헌
2022-01-20

## 미션과 문제

년도, 월, 일, 요일, 오전 오후, 시간 등 데이터 분석에 필요한 각종 변수를
만들고자 합니다. 문제는 카톡에서 출력된 일시(2019년 2월 27일 오후 11:02)
데이터는 R에서 사용하는 일반적인 형태가 아닙니다. 따라서 전처리 과정을
통해 일반적인 형태의 날짜로 바꾸고 이를 바탕으로 년, 월, 일, 요일 등
다양한 변수를 만들어 내야 합니다.

## 최종 결과 확인

다음과 같이 데이터를 전처리하면 된다:

``` r
library(tidyverse)
(rdata <- read_file("../data/KakaoTalkChatsSample.txt") %>%                    # txt 파일 읽어오기
    strsplit("\r") %>% unlist() %>%                                       # 같은 사람의 글은 한 줄로
    gsub("\n", "", .) %>% as_tibble() %>%                                 # 줄바꿈 없애기
    filter(grepl("^\\d.*,.*:", value)) %>%                                # 숫자시작 , : 있는 것만
    separate(value, into=c("date", "text"), sep=", ", extra="merge") %>%  # 날짜와 글 분리
    separate(text, into=c("name", "coment"), sep=" : ", extra="merge"))   # 이름과 글 내용 분리
```

    ## # A tibble: 12 x 3
    ##    date                       name  coment                                      
    ##    <chr>                      <chr> <chr>                                       
    ##  1 2019년 2월 27일 오후 11:02 ◇◇◇   오늘 강연 고맙게 잘~ 들었습니다 김OO 교수님~
    ##  2 2019년 2월 27일 오후 11:02 □□□   (굿)                                        
    ##  3 2019년 2월 28일 오후 7:08  □□□   사진                                        
    ##  4 2019년 2월 28일 오후 7:08  □□□   저희도 동참합니다 ^^                        
    ##  5 2019년 2월 28일 오후 8:57  ▣▣▣   (최고)                                      
    ##  6 2019년 3월 1일 오전 9:49   ◁◁◁   사진                                        
    ##  7 2019년 3월 1일 오전 9:50   ◁◁◁   Deepfake와 포토샵으로 합성된 사진을 인공지~ 
    ##  8 2019년 3월 1일 오후 1:26   □□□   이모티콘                                    
    ##  9 2019년 3월 1일 오후 1:26   □□□   사진                                        
    ## 10 2019년 3월 1일 오후 2:06   ◁◁◁   와!                                         
    ## 11 2019년 3월 2일 오후 8:22   △△△   https://www.youtube.com/watch?v=Iua-Z36J80A 
    ## 12 2019년 3월 2일 오후 8:22   △△△   R에서 10줄로 구현한 keras입니다. ^^

``` r
library(lubridate)
(data <- rdata)  
```

    ## # A tibble: 12 x 3
    ##    date                       name  coment                                      
    ##    <chr>                      <chr> <chr>                                       
    ##  1 2019년 2월 27일 오후 11:02 ◇◇◇   오늘 강연 고맙게 잘~ 들었습니다 김OO 교수님~
    ##  2 2019년 2월 27일 오후 11:02 □□□   (굿)                                        
    ##  3 2019년 2월 28일 오후 7:08  □□□   사진                                        
    ##  4 2019년 2월 28일 오후 7:08  □□□   저희도 동참합니다 ^^                        
    ##  5 2019년 2월 28일 오후 8:57  ▣▣▣   (최고)                                      
    ##  6 2019년 3월 1일 오전 9:49   ◁◁◁   사진                                        
    ##  7 2019년 3월 1일 오전 9:50   ◁◁◁   Deepfake와 포토샵으로 합성된 사진을 인공지~ 
    ##  8 2019년 3월 1일 오후 1:26   □□□   이모티콘                                    
    ##  9 2019년 3월 1일 오후 1:26   □□□   사진                                        
    ## 10 2019년 3월 1일 오후 2:06   ◁◁◁   와!                                         
    ## 11 2019년 3월 2일 오후 8:22   △△△   https://www.youtube.com/watch?v=Iua-Z36J80A 
    ## 12 2019년 3월 2일 오후 8:22   △△△   R에서 10줄로 구현한 keras입니다. ^^

## 코드 설명

### 예고

다음 글에서는 발언수가 많은 상위 10명, 요일별 발언수, 오전 오후의 발언수
차이 등 카톡 방에서 주고 받은 대화들과 관련된 각종 시각화 자료를 얻어
보겠습니다.
